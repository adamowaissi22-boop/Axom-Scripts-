local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

local AxocaUi = {}
AxocaUi.__index = AxocaUi

function AxocaUi.new()
    local self = setmetatable({}, AxocaUi)
    
    self.elements = {}
    self.pages = {}
    self.currentPage = nil
    self.themes = {
        Dark = {Background = Color3.fromRGB(30, 30, 30), Text = Color3.fromRGB(255, 255, 255), Accent = Color3.fromRGB(100, 100, 100)},
        Blue = {Background = Color3.fromRGB(0, 0, 139), Text = Color3.fromRGB(255, 255, 255), Accent = Color3.fromRGB(65, 105, 225)},
        Cyan = {Background = Color3.fromRGB(0, 139, 139), Text = Color3.fromRGB(255, 255, 255), Accent = Color3.fromRGB(0, 255, 255)},
        Red = {Background = Color3.fromRGB(139, 0, 0), Text = Color3.fromRGB(255, 255, 255), Accent = Color3.fromRGB(255, 0, 0)},
        Neon = {Background = Color3.fromRGB(0, 0, 0), Text = Color3.fromRGB(255, 255, 255), Accent = Color3.fromRGB(0, 255, 0)},
        Yellow = {Background = Color3.fromRGB(139, 139, 0), Text = Color3.fromRGB(0, 0, 0), Accent = Color3.fromRGB(255, 255, 0)},
        White = {Background = Color3.fromRGB(255, 255, 255), Text = Color3.fromRGB(0, 0, 0), Accent = Color3.fromRGB(200, 200, 200)},
        Grey = {Background = Color3.fromRGB(128, 128, 128), Text = Color3.fromRGB(255, 255, 255), Accent = Color3.fromRGB(169, 169, 169)},
        SkyBlue = {Background = Color3.fromRGB(135, 206, 235), Text = Color3.fromRGB(0, 0, 0), Accent = Color3.fromRGB(173, 216, 230)},
        DarkWhite = {Background = Color3.fromRGB(200, 200, 200), Text = Color3.fromRGB(0, 0, 0), Accent = Color3.fromRGB(150, 150, 150)},
        DarkBlue = {Background = Color3.fromRGB(0, 0, 100), Text = Color3.fromRGB(255, 255, 255), Accent = Color3.fromRGB(0, 0, 139)}
    }
    self.currentTheme = "Dark"
    
    self:CreateMainUI()
    self:CreateSettings()
    
    return self
end

function AxocaUi:CreateMainUI()
    self.mainFrame = Instance.new("ScreenGui")
    self.mainFrame.Name = "AxocaUi"
    self.mainFrame.ResetOnSpawn = false
    self.mainFrame.Parent = player:WaitForChild("PlayerGui")
    
    local mainContainer = Instance.new("Frame")
    mainContainer.Name = "MainContainer"
    mainContainer.Size = UDim2.new(0, 350, 0, 400)
    mainContainer.Position = UDim2.new(0.5, -175, 0.5, -200)
    mainContainer.BackgroundColor3 = self.themes[self.currentTheme].Background
    mainContainer.BorderSizePixel = 0
    mainContainer.ClipsDescendants = true
    mainContainer.Parent = self.mainFrame
    
    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 30)
    titleBar.BackgroundColor3 = self.themes[self.currentTheme].Accent
    titleBar.BorderSizePixel = 0
    titleBar.Parent = mainContainer
    
    local titleText = Instance.new("TextLabel")
    titleText.Name = "TitleText"
    titleText.Size = UDim2.new(0.7, 0, 1, 0)
    titleText.BackgroundTransparency = 1
    titleText.Text = "Axoca Ui"
    titleText.TextColor3 = self.themes[self.currentTheme].Text
    titleText.Font = Enum.Font.GothamBold
    titleText.TextSize = 14
    titleText.Parent = titleBar
    
    local minimizeBtn = Instance.new("TextButton")
    minimizeBtn.Name = "MinimizeBtn"
    minimizeBtn.Size = UDim2.new(0, 30, 1, 0)
    minimizeBtn.Position = UDim2.new(0.7, 0, 0, 0)
    minimizeBtn.BackgroundColor3 = self.themes[self.currentTheme].Accent
    minimizeBtn.BorderSizePixel = 0
    minimizeBtn.Text = "-"
    minimizeBtn.TextColor3 = self.themes[self.currentTheme].Text
    minimizeBtn.Font = Enum.Font.GothamBold
    minimizeBtn.TextSize = 14
    minimizeBtn.Parent = titleBar
    
    local closeBtn = Instance.new("TextButton")
    closeBtn.Name = "CloseBtn"
    closeBtn.Size = UDim2.new(0, 30, 1, 0)
    closeBtn.Position = UDim2.new(0.8, 0, 0, 0)
    closeBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    closeBtn.BorderSizePixel = 0
    closeBtn.Text = "X"
    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 14
    closeBtn.Parent = titleBar
    
    local settingsBtn = Instance.new("TextButton")
    settingsBtn.Name = "SettingsBtn"
    settingsBtn.Size = UDim2.new(0, 30, 1, 0)
    settingsBtn.Position = UDim2.new(0.9, 0, 0, 0)
    settingsBtn.BackgroundColor3 = self.themes[self.currentTheme].Accent
    settingsBtn.BorderSizePixel = 0
    settingsBtn.Text = "⚙"
    settingsBtn.TextColor3 = self.themes[self.currentTheme].Text
    settingsBtn.Font = Enum.Font.GothamBold
    settingsBtn.TextSize = 14
    settingsBtn.Parent = titleBar
    
    local sectionContainer = Instance.new("Frame")
    sectionContainer.Name = "SectionContainer"
    sectionContainer.Size = UDim2.new(1, 0, 0, 40)
    sectionContainer.Position = UDim2.new(0, 0, 0, 30)
    sectionContainer.BackgroundColor3 = self.themes[self.currentTheme].Background
    sectionContainer.BorderSizePixel = 0
    sectionContainer.Parent = mainContainer
    
    local sectionScrolling = Instance.new("ScrollingFrame")
    sectionScrolling.Name = "SectionScrolling"
    sectionScrolling.Size = UDim2.new(1, 0, 1, 0)
    sectionScrolling.BackgroundTransparency = 1
    sectionScrolling.BorderSizePixel = 0
    sectionScrolling.ScrollBarThickness = 0
    sectionScrolling.CanvasSize = UDim2.new(0, 0, 0, 0)
    sectionScrolling.Parent = sectionContainer
    
    local sectionList = Instance.new("UIListLayout")
    sectionList.Name = "SectionList"
    sectionList.FillDirection = Enum.FillDirection.Horizontal
    sectionList.Padding = UDim.new(0, 5)
    sectionList.Parent = sectionScrolling
    
    self.contentContainer = Instance.new("Frame")
    self.contentContainer.Name = "ContentContainer"
    self.contentContainer.Size = UDim2.new(1, 0, 1, -70)
    self.contentContainer.Position = UDim2.new(0, 0, 0, 70)
    self.contentContainer.BackgroundColor3 = self.themes[self.currentTheme].Background
    self.contentContainer.BorderSizePixel = 0
    self.contentContainer.Parent = mainContainer
    
    self.contentScrolling = Instance.new("ScrollingFrame")
    self.contentScrolling.Name = "ContentScrolling"
    self.contentScrolling.Size = UDim2.new(1, 0, 1, 0)
    self.contentScrolling.BackgroundTransparency = 1
    self.contentScrolling.BorderSizePixel = 0
    self.contentScrolling.ScrollBarThickness = 3
    self.contentScrolling.AutomaticCanvasSize = Enum.AutomaticSize.Y
    self.contentScrolling.Parent = self.contentContainer
    
    local contentList = Instance.new("UIListLayout")
    contentList.Name = "ContentList"
    contentList.Padding = UDim.new(0, 5)
    contentList.Parent = self.contentScrolling
    
    self.dragging = false
    self.dragInput = nil
    self.dragStart = nil
    self.startPos = nil
    
    local function updateInput(input)
        local delta = input.Position - self.dragStart
        mainContainer.Position = UDim2.new(self.startPos.X.Scale, self.startPos.X.Offset + delta.X, self.startPos.Y.Scale, self.startPos.Y.Offset + delta.Y)
    end
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            self.dragging = true
            self.dragStart = input.Position
            self.startPos = mainContainer.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    self.dragging = false
                end
            end)
        end
    end)
    
    titleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            self.dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == self.dragInput and self.dragging then
            updateInput(input)
        end
    end)
    
    minimizeBtn.MouseButton1Click:Connect(function()
        if mainContainer.Size.Y.Offset == 70 then
            mainContainer.Size = UDim2.new(0, 350, 0, 400)
        else
            mainContainer.Size = UDim2.new(0, 350, 0, 70)
        end
    end)
    
    closeBtn.MouseButton1Click:Connect(function()
        self.mainFrame:Destroy()
    end)
    
    settingsBtn.MouseButton1Click:Connect(function()
        self:ShowSettings()
    end)
    
    self.mainContainer = mainContainer
    self.sectionScrolling = sectionScrolling
end

function AxocaUi:CreateSettings()
    self.settingsFrame = Instance.new("Frame")
    self.settingsFrame.Name = "SettingsFrame"
    self.settingsFrame.Size = UDim2.new(0, 300, 0, 300)
    self.settingsFrame.Position = UDim2.new(0.5, -150, 0.5, -150)
    self.settingsFrame.BackgroundColor3 = self.themes[self.currentTheme].Background
    self.settingsFrame.BorderSizePixel = 0
    self.settingsFrame.Visible = false
    self.settingsFrame.Parent = self.mainFrame
    
    local settingsTitle = Instance.new("TextLabel")
    settingsTitle.Name = "SettingsTitle"
    settingsTitle.Size = UDim2.new(1, 0, 0, 30)
    settingsTitle.BackgroundColor3 = self.themes[self.currentTheme].Accent
    settingsTitle.BorderSizePixel = 0
    settingsTitle.Text = "Settings"
    settingsTitle.TextColor3 = self.themes[self.currentTheme].Text
    settingsTitle.Font = Enum.Font.GothamBold
    settingsTitle.TextSize = 16
    settingsTitle.Parent = self.settingsFrame
    
    local closeSettings = Instance.new("TextButton")
    closeSettings.Name = "CloseSettings"
    closeSettings.Size = UDim2.new(0, 30, 0, 30)
    closeSettings.Position = UDim2.new(1, -30, 0, 0)
    closeSettings.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    closeSettings.BorderSizePixel = 0
    closeSettings.Text = "X"
    closeSettings.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeSettings.Font = Enum.Font.GothamBold
    closeSettings.TextSize = 14
    closeSettings.Parent = self.settingsFrame
    
    local themeDropdown = Instance.new("TextButton")
    themeDropdown.Name = "ThemeDropdown"
    themeDropdown.Size = UDim2.new(0.8, 0, 0, 30)
    themeDropdown.Position = UDim2.new(0.1, 0, 0, 50)
    themeDropdown.BackgroundColor3 = self.themes[self.currentTheme].Accent
    themeDropdown.BorderSizePixel = 0
    themeDropdown.Text = "Theme: " .. self.currentTheme
    themeDropdown.TextColor3 = self.themes[self.currentTheme].Text
    themeDropdown.Font = Enum.Font.Gotham
    themeDropdown.TextSize = 14
    themeDropdown.Parent = self.settingsFrame
    
    local themeList = Instance.new("ScrollingFrame")
    themeList.Name = "ThemeList"
    themeList.Size = UDim2.new(0.8, 0, 0, 150)
    themeList.Position = UDim2.new(0.1, 0, 0, 85)
    themeList.BackgroundColor3 = self.themes[self.currentTheme].Background
    themeList.BorderSizePixel = 0
    themeList.ScrollBarThickness = 3
    themeList.Visible = false
    themeList.AutomaticCanvasSize = Enum.AutomaticSize.Y
    themeList.Parent = self.settingsFrame
    
    local themeListLayout = Instance.new("UIListLayout")
    themeListLayout.Parent = themeList
    
    for themeName, _ in pairs(self.themes) do
        local themeBtn = Instance.new("TextButton")
        themeBtn.Name = themeName
        themeBtn.Size = UDim2.new(1, 0, 0, 25)
        themeBtn.BackgroundColor3 = self.themes[self.currentTheme].Accent
        themeBtn.BorderSizePixel = 0
        themeBtn.Text = themeName
        themeBtn.TextColor3 = self.themes[self.currentTheme].Text
        themeBtn.Font = Enum.Font.Gotham
        themeBtn.TextSize = 12
        themeBtn.Parent = themeList
        
        themeBtn.MouseButton1Click:Connect(function()
            self:ChangeTheme(themeName)
            themeDropdown.Text = "Theme: " .. themeName
            themeList.Visible = false
        end)
    end
    
    themeDropdown.MouseButton1Click:Connect(function()
        themeList.Visible = not themeList.Visible
    end)
    
    closeSettings.MouseButton1Click:Connect(function()
        self.settingsFrame.Visible = false
    end)
end

function AxocaUi:ShowSettings()
    self.settingsFrame.Visible = true
end

function AxocaUi:ChangeTheme(themeName)
    self.currentTheme = themeName
    local theme = self.themes[themeName]
    
    self.mainContainer.BackgroundColor3 = theme.Background
    self.mainContainer.TitleBar.BackgroundColor3 = theme.Accent
    self.mainContainer.TitleBar.TitleText.TextColor3 = theme.Text
    self.mainContainer.TitleBar.MinimizeBtn.BackgroundColor3 = theme.Accent
    self.mainContainer.TitleBar.MinimizeBtn.TextColor3 = theme.Text
    self.mainContainer.TitleBar.SettingsBtn.BackgroundColor3 = theme.Accent
    self.mainContainer.TitleBar.SettingsBtn.TextColor3 = theme.Text
    self.mainContainer.SectionContainer.BackgroundColor3 = theme.Background
    self.mainContainer.ContentContainer.BackgroundColor3 = theme.Background
    
    for _, page in pairs(self.pages) do
        for _, element in pairs(page.elements) do
            if element:IsA("TextLabel") or element:IsA("TextButton") then
                element.TextColor3 = theme.Text
            elseif element:IsA("Frame") then
                if element.Name == "Button" or element.Name == "Toggle" or element.Name == "Slider" or element.Name == "Box" or element.Name == "Dropdown" or element.Name == "PlayerSelector" or element.Name == "Label" or element.Name == "ColorPicker" or element.Name == "KeyBind" or element.Name == "Switch" then
                    element.BackgroundColor3 = theme.Accent
                end
            end
        end
    end
    
    self.settingsFrame.BackgroundColor3 = theme.Background
    self.settingsFrame.SettingsTitle.BackgroundColor3 = theme.Accent
    self.settingsFrame.SettingsTitle.TextColor3 = theme.Text
    self.settingsFrame.ThemeDropdown.BackgroundColor3 = theme.Accent
    self.settingsFrame.ThemeDropdown.TextColor3 = theme.Text
    self.settingsFrame.ThemeList.BackgroundColor3 = theme.Background
    
    for _, themeBtn in pairs(self.settingsFrame.ThemeList:GetChildren()) do
        if themeBtn:IsA("TextButton") then
            themeBtn.BackgroundColor3 = theme.Accent
            themeBtn.TextColor3 = theme.Text
        end
    end
end

function AxocaUi:AddSection(name)
    local sectionBtn = Instance.new("TextButton")
    sectionBtn.Name = name
    sectionBtn.Size = UDim2.new(0, 80, 0, 30)
    sectionBtn.BackgroundColor3 = self.themes[self.currentTheme].Accent
    sectionBtn.BorderSizePixel = 0
    sectionBtn.Text = name
    sectionBtn.TextColor3 = self.themes[self.currentTheme].Text
    sectionBtn.Font = Enum.Font.Gotham
    sectionBtn.TextSize = 12
    sectionBtn.Parent = self.sectionScrolling
    
    local pageFrame = Instance.new("ScrollingFrame")
    pageFrame.Name = name
    pageFrame.Size = UDim2.new(1, 0, 1, 0)
    pageFrame.BackgroundTransparency = 1
    pageFrame.BorderSizePixel = 0
    pageFrame.ScrollBarThickness = 3
    pageFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    pageFrame.Visible = false
    pageFrame.Parent = self.contentScrolling
    
    local pageList = Instance.new("UIListLayout")
    pageList.Name = "PageList"
    pageList.Padding = UDim.new(0, 5)
    pageList.Parent = pageFrame
    
    self.pages[name] = {frame = pageFrame, elements = {}}
    
    if not self.currentPage then
        self.currentPage = name
        pageFrame.Visible = true
        sectionBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
    end
    
    sectionBtn.MouseButton1Click:Connect(function()
        for _, page in pairs(self.pages) do
            page.frame.Visible = false
        end
        for _, btn in pairs(self.sectionScrolling:GetChildren()) do
            if btn:IsA("TextButton") then
                btn.BackgroundColor3 = self.themes[self.currentTheme].Accent
            end
        end
        pageFrame.Visible = true
        sectionBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
        self.currentPage = name
    end)
    
    self.sectionScrolling.CanvasSize = UDim2.new(0, self.sectionScrolling.UIListLayout.AbsoluteContentSize.X, 0, 0)
    
    return self.pages[name]
end

function AxocaUi:AddButton(section, text, callback)
    local page = self.pages[section]
    if not page then return end
    
    local button = Instance.new("TextButton")
    button.Name = "Button"
    button.Size = UDim2.new(0.9, 0, 0, 30)
    button.Position = UDim2.new(0.05, 0, 0, 0)
    button.BackgroundColor3 = self.themes[self.currentTheme].Accent
    button.BorderSizePixel = 0
    button.Text = text
    button.TextColor3 = self.themes[self.currentTheme].Text
    button.Font = Enum.Font.Gotham
    button.TextSize = 14
    button.Parent = page.frame
    
    button.MouseButton1Click:Connect(callback)
    
    table.insert(page.elements, button)
    return button
end

function AxocaUi:AddToggle(section, text, callback)
    local page = self.pages[section]
    if not page then return end
    
    local toggleFrame = Instance.new("Frame")
    toggleFrame.Name = "Toggle"
    toggleFrame.Size = UDim2.new(0.9, 0, 0, 30)
    toggleFrame.Position = UDim2.new(0.05, 0, 0, 0)
    toggleFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    toggleFrame.BorderSizePixel = 0
    toggleFrame.Parent = page.frame
    
    local toggleText = Instance.new("TextLabel")
    toggleText.Name = "Text"
    toggleText.Size = UDim2.new(0.7, 0, 1, 0)
    toggleText.BackgroundTransparency = 1
    toggleText.Text = text
    toggleText.TextColor3 = self.themes[self.currentTheme].Text
    toggleText.Font = Enum.Font.Gotham
    toggleText.TextSize = 14
    toggleText.TextXAlignment = Enum.TextXAlignment.Left
    toggleText.Parent = toggleFrame
    
    local toggleBtn = Instance.new("TextButton")
    toggleBtn.Name = "ToggleBtn"
    toggleBtn.Size = UDim2.new(0, 20, 0, 20)
    toggleBtn.Position = UDim2.new(0.9, -20, 0.5, -10)
    toggleBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    toggleBtn.BorderSizePixel = 0
    toggleBtn.Text = ""
    toggleBtn.Parent = toggleFrame
    
    local state = false
    
    local function updateToggle()
        if state then
            toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        else
            toggleBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        end
        callback(state)
    end
    
    toggleBtn.MouseButton1Click:Connect(function()
        state = not state
        updateToggle()
    end)
    
    table.insert(page.elements, toggleFrame)
    return toggleFrame
end

function AxocaUi:AddImage(section, imageId, size)
    local page = self.pages[section]
    if not page then return end
    
    local image = Instance.new("ImageLabel")
    image.Name = "Image"
    image.Size = size or UDim2.new(0.9, 0, 0, 150)
    image.Position = UDim2.new(0.05, 0, 0, 0)
    image.BackgroundTransparency = 1
    image.Image = imageId
    image.Parent = page.frame
    
    table.insert(page.elements, image)
    return image
end

function AxocaUi:AddSlider(section, text, min, max, callback)
    local page = self.pages[section]
    if not page then return end
    
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Name = "Slider"
    sliderFrame.Size = UDim2.new(0.9, 0, 0, 50)
    sliderFrame.Position = UDim2.new(0.05, 0, 0, 0)
    sliderFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    sliderFrame.BorderSizePixel = 0
    sliderFrame.Parent = page.frame
    
    local sliderText = Instance.new("TextLabel")
    sliderText.Name = "Text"
    sliderText.Size = UDim2.new(1, 0, 0, 20)
    sliderText.BackgroundTransparency = 1
    sliderText.Text = text .. ": " .. min
    sliderText.TextColor3 = self.themes[self.currentTheme].Text
    sliderText.Font = Enum.Font.Gotham
    sliderText.TextSize = 14
    sliderText.Parent = sliderFrame
    
    local sliderBar = Instance.new("Frame")
    sliderBar.Name = "Bar"
    sliderBar.Size = UDim2.new(0.9, 0, 0, 10)
    sliderBar.Position = UDim2.new(0.05, 0, 0, 30)
    sliderBar.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    sliderBar.BorderSizePixel = 0
    sliderBar.Parent = sliderFrame
    
    local sliderFill = Instance.new("Frame")
    sliderFill.Name = "Fill"
    sliderFill.Size = UDim2.new(0, 0, 1, 0)
    sliderFill.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    sliderFill.BorderSizePixel = 0
    sliderFill.Parent = sliderBar
    
    local sliderBtn = Instance.new("TextButton")
    sliderBtn.Name = "SliderBtn"
    sliderBtn.Size = UDim2.new(0, 20, 0, 20)
    sliderBtn.Position = UDim2.new(0, -10, 0, -5)
    sliderBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    sliderBtn.BorderSizePixel = 0
    sliderBtn.Text = ""
    sliderBtn.Parent = sliderFill
    
    local dragging = false
    
    local function updateSlider(value)
        local percent = (value - min) / (max - min)
        sliderFill.Size = UDim2.new(percent, 0, 1, 0)
        sliderText.Text = text .. ": " .. math.floor(value)
        callback(value)
    end
    
    sliderBtn.MouseButton1Down:Connect(function()
        dragging = true
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    sliderBar.MouseButton1Down:Connect(function(x, y)
        local percent = (x - sliderBar.AbsolutePosition.X) / sliderBar.AbsoluteSize.X
        local value = min + (max - min) * percent
        value = math.clamp(value, min, max)
        updateSlider(value)
    end)
    
    game:GetService("RunService").RenderStepped:Connect(function()
        if dragging then
            local mousePos = UserInputService:GetMouseLocation()
            local percent = (mousePos.X - sliderBar.AbsolutePosition.X) / sliderBar.AbsoluteSize.X
            local value = min + (max - min) * percent
            value = math.clamp(value, min, max)
            updateSlider(value)
        end
    end)
    
    table.insert(page.elements, sliderFrame)
    return sliderFrame
end

function AxocaUi:AddBox(section, text, callback)
    local page = self.pages[section]
    if not page then return end
    
    local boxFrame = Instance.new("Frame")
    boxFrame.Name = "Box"
    boxFrame.Size = UDim2.new(0.9, 0, 0, 30)
    boxFrame.Position = UDim2.new(0.05, 0, 0, 0)
    boxFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    boxFrame.BorderSizePixel = 0
    boxFrame.Parent = page.frame
    
    local boxText = Instance.new("TextLabel")
    boxText.Name = "Text"
    boxText.Size = UDim2.new(0.3, 0, 1, 0)
    boxText.BackgroundTransparency = 1
    boxText.Text = text
    boxText.TextColor3 = self.themes[self.currentTheme].Text
    boxText.Font = Enum.Font.Gotham
    boxText.TextSize = 14
    boxText.TextXAlignment = Enum.TextXAlignment.Left
    boxText.Parent = boxFrame
    
    local textBox = Instance.new("TextBox")
    textBox.Name = "TextBox"
    textBox.Size = UDim2.new(0.6, 0, 0.8, 0)
    textBox.Position = UDim2.new(0.35, 0, 0.1, 0)
    textBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    textBox.BorderSizePixel = 0
    textBox.Text = ""
    textBox.TextColor3 = self.themes[self.currentTheme].Text
    textBox.Font = Enum.Font.Gotham
    textBox.TextSize = 14
    textBox.Parent = boxFrame
    
    textBox.FocusLost:Connect(function()
        callback(textBox.Text)
    end)
    
    table.insert(page.elements, boxFrame)
    return boxFrame
end

function AxocaUi:AddDropdown(section, text, options, callback)
    local page = self.pages[section]
    if not page then return end
    
    local dropdownFrame = Instance.new("Frame")
    dropdownFrame.Name = "Dropdown"
    dropdownFrame.Size = UDim2.new(0.9, 0, 0, 30)
    dropdownFrame.Position = UDim2.new(0.05, 0, 0, 0)
    dropdownFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    dropdownFrame.BorderSizePixel = 0
    dropdownFrame.ClipsDescendants = true
    dropdownFrame.Parent = page.frame
    
    local dropdownText = Instance.new("TextLabel")
    dropdownText.Name = "Text"
    dropdownText.Size = UDim2.new(0.7, 0, 1, 0)
    dropdownText.BackgroundTransparency = 1
    dropdownText.Text = text
    dropdownText.TextColor3 = self.themes[self.currentTheme].Text
    dropdownText.Font = Enum.Font.Gotham
    dropdownText.TextSize = 14
    dropdownText.TextXAlignment = Enum.TextXAlignment.Left
    dropdownText.Parent = dropdownFrame
    
    local dropdownBtn = Instance.new("TextButton")
    dropdownBtn.Name = "DropdownBtn"
    dropdownBtn.Size = UDim2.new(0, 20, 0, 20)
    dropdownBtn.Position = UDim2.new(0.9, -20, 0.5, -10)
    dropdownBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    dropdownBtn.BorderSizePixel = 0
    dropdownBtn.Text = "▼"
    dropdownBtn.TextColor3 = self.themes[self.currentTheme].Text
    dropdownBtn.Font = Enum.Font.Gotham
    dropdownBtn.TextSize = 12
    dropdownBtn.Parent = dropdownFrame
    
    local dropdownList = Instance.new("ScrollingFrame")
    dropdownList.Name = "DropdownList"
    dropdownList.Size = UDim2.new(1, 0, 0, 0)
    dropdownList.Position = UDim2.new(0, 0, 1, 0)
    dropdownList.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    dropdownList.BorderSizePixel = 0
    dropdownList.ScrollBarThickness = 3
    dropdownList.AutomaticCanvasSize = Enum.AutomaticSize.Y
    dropdownList.Visible = false
    dropdownList.Parent = dropdownFrame
    
    local dropdownListLayout = Instance.new("UIListLayout")
    dropdownListLayout.Parent = dropdownList
    
    local isOpen = false
    
    local function toggleDropdown()
        isOpen = not isOpen
        if isOpen then
            dropdownList.Visible = true
            dropdownFrame.Size = UDim2.new(0.9, 0, 0, 30 + math.min(#options * 25, 100))
            dropdownList.Size = UDim2.new(1, 0, 0, math.min(#options * 25, 100))
        else
            dropdownList.Visible = false
            dropdownFrame.Size = UDim2.new(0.9, 0, 0, 30)
        end
    end
    
    for _, option in pairs(options) do
        local optionBtn = Instance.new("TextButton")
        optionBtn.Name = option
        optionBtn.Size = UDim2.new(1, 0, 0, 25)
        optionBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
        optionBtn.BorderSizePixel = 0
        optionBtn.Text = option
        optionBtn.TextColor3 = self.themes[self.currentTheme].Text
        optionBtn.Font = Enum.Font.Gotham
        optionBtn.TextSize = 12
        optionBtn.Parent = dropdownList
        
        optionBtn.MouseButton1Click:Connect(function()
            callback(option)
            dropdownText.Text = text .. ": " .. option
            toggleDropdown()
        end)
    end
    
    dropdownBtn.MouseButton1Click:Connect(toggleDropdown)
    
    table.insert(page.elements, dropdownFrame)
    return dropdownFrame
end

function AxocaUi:AddPlayerSelector(section, text, callback)
    local page = self.pages[section]
    if not page then return end
    
    local playerFrame = Instance.new("Frame")
    playerFrame.Name = "PlayerSelector"
    playerFrame.Size = UDim2.new(0.9, 0, 0, 30)
    playerFrame.Position = UDim2.new(0.05, 0, 0, 0)
    playerFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    playerFrame.BorderSizePixel = 0
    playerFrame.ClipsDescendants = true
    playerFrame.Parent = page.frame
    
    local playerText = Instance.new("TextLabel")
    playerText.Name = "Text"
    playerText.Size = UDim2.new(0.7, 0, 1, 0)
    playerText.BackgroundTransparency = 1
    playerText.Text = text
    playerText.TextColor3 = self.themes[self.currentTheme].Text
    playerText.Font = Enum.Font.Gotham
    playerText.TextSize = 14
    playerText.TextXAlignment = Enum.TextXAlignment.Left
    playerText.Parent = playerFrame
    
    local playerBtn = Instance.new("TextButton")
    playerBtn.Name = "PlayerBtn"
    playerBtn.Size = UDim2.new(0, 20, 0, 20)
    playerBtn.Position = UDim2.new(0.9, -20, 0.5, -10)
    playerBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    playerBtn.BorderSizePixel = 0
    playerBtn.Text = "▼"
    playerBtn.TextColor3 = self.themes[self.currentTheme].Text
    playerBtn.Font = Enum.Font.Gotham
    playerBtn.TextSize = 12
    playerBtn.Parent = playerFrame
    
    local playerList = Instance.new("ScrollingFrame")
    playerList.Name = "PlayerList"
    playerList.Size = UDim2.new(1, 0, 0, 0)
    playerList.Position = UDim2.new(0, 0, 1, 0)
    playerList.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    playerList.BorderSizePixel = 0
    playerList.ScrollBarThickness = 3
    playerList.AutomaticCanvasSize = Enum.AutomaticSize.Y
    playerList.Visible = false
    playerList.Parent = playerFrame
    
    local playerListLayout = Instance.new("UIListLayout")
    playerListLayout.Parent = playerList
    
    local isOpen = false
    
    local function togglePlayerList()
        isOpen = not isOpen
        if isOpen then
            playerList.Visible = true
            local playerCount = #Players:GetPlayers()
            playerFrame.Size = UDim2.new(0.9, 0, 0, 30 + math.min(playerCount * 25, 100))
            playerList.Size = UDim2.new(1, 0, 0, math.min(playerCount * 25, 100))
            
            for _, v in pairs(playerList:GetChildren()) do
                if v:IsA("TextButton") then
                    v:Destroy()
                end
            end
            
            for _, player in pairs(Players:GetPlayers()) do
                local playerBtn = Instance.new("TextButton")
                playerBtn.Name = player.Name
                playerBtn.Size = UDim2.new(1, 0, 0, 25)
                playerBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
                playerBtn.BorderSizePixel = 0
                playerBtn.Text = player.Name
                playerBtn.TextColor3 = self.themes[self.currentTheme].Text
                playerBtn.Font = Enum.Font.Gotham
                playerBtn.TextSize = 12
                playerBtn.Parent = playerList
                
                playerBtn.MouseButton1Click:Connect(function()
                    callback(player)
                    playerText.Text = text .. ": " .. player.Name
                    togglePlayerList()
                end)
            end
        else
            playerList.Visible = false
            playerFrame.Size = UDim2.new(0.9, 0, 0, 30)
        end
    end
    
    playerBtn.MouseButton1Click:Connect(togglePlayerList)
    
    table.insert(page.elements, playerFrame)
    return playerFrame
end

function AxocaUi:AddText(section, text)
    local page = self.pages[section]
    if not page then return end
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Name = "Text"
    textLabel.Size = UDim2.new(0.9, 0, 0, 20)
    textLabel.Position = UDim2.new(0.05, 0, 0, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = text
    textLabel.TextColor3 = self.themes[self.currentTheme].Text
    textLabel.Font = Enum.Font.Gotham
    textLabel.TextSize = 14
    textLabel.Parent = page.frame
    
    table.insert(page.elements, textLabel)
    return textLabel
end

function AxocaUi:AddLabel(section, text)
    local page = self.pages[section]
    if not page then return end
    
    local labelFrame = Instance.new("Frame")
    labelFrame.Name = "Label"
    labelFrame.Size = UDim2.new(0.9, 0, 0, 30)
    labelFrame.Position = UDim2.new(0.05, 0, 0, 0)
    labelFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    labelFrame.BorderSizePixel = 0
    labelFrame.Parent = page.frame
    
    local labelText = Instance.new("TextLabel")
    labelText.Name = "Text"
    labelText.Size = UDim2.new(1, 0, 1, 0)
    labelText.BackgroundTransparency = 1
    labelText.Text = text
    labelText.TextColor3 = self.themes[self.currentTheme].Text
    labelText.Font = Enum.Font.GothamBold
    labelText.TextSize = 14
    labelText.Parent = labelFrame
    
    table.insert(page.elements, labelFrame)
    return labelFrame
end

function AxocaUi:AddColorPicker(section, text, callback)
    local page = self.pages[section]
    if not page then return end
    
    local colorFrame = Instance.new("Frame")
    colorFrame.Name = "ColorPicker"
    colorFrame.Size = UDim2.new(0.9, 0, 0, 30)
    colorFrame.Position = UDim2.new(0.05, 0, 0, 0)
    colorFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    colorFrame.BorderSizePixel = 0
    colorFrame.Parent = page.frame
    
    local colorText = Instance.new("TextLabel")
    colorText.Name = "Text"
    colorText.Size = UDim2.new(0.7, 0, 1, 0)
    colorText.BackgroundTransparency = 1
    colorText.Text = text
    colorText.TextColor3 = self.themes[self.currentTheme].Text
    colorText.Font = Enum.Font.Gotham
    colorText.TextSize = 14
    colorText.TextXAlignment = Enum.TextXAlignment.Left
    colorText.Parent = colorFrame
    
    local colorBtn = Instance.new("TextButton")
    colorBtn.Name = "ColorBtn"
    colorBtn.Size = UDim2.new(0, 20, 0, 20)
    colorBtn.Position = UDim2.new(0.9, -20, 0.5, -10)
    colorBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    colorBtn.BorderSizePixel = 0
    colorBtn.Text = ""
    colorBtn.Parent = colorFrame
    
    colorBtn.MouseButton1Click:Connect(function()
        local color = Color3.fromRGB(math.random(0, 255), math.random(0, 255), math.random(0, 255))
        colorBtn.BackgroundColor3 = color
        callback(color)
    end)
    
    table.insert(page.elements, colorFrame)
    return colorFrame
end

function AxocaUi:AddKeyBind(section, text, callback)
    local page = self.pages[section]
    if not page then return end
    
    local keyFrame = Instance.new("Frame")
    keyFrame.Name = "KeyBind"
    keyFrame.Size = UDim2.new(0.9, 0, 0, 30)
    keyFrame.Position = UDim2.new(0.05, 0, 0, 0)
    keyFrame.BackgroundColor3 = self.themes[self.currentTheme].Accent
    keyFrame.BorderSizePixel = 0
    keyFrame.Parent = page.frame
    
    local keyText = Instance.new("TextLabel")
    keyText.Name = "Text"
    keyText.Size = UDim2.new(0.7, 0, 1, 0)
    keyText.BackgroundTransparency = 1
    keyText.Text = text
    keyText.TextColor3 = self.themes[self.currentTheme].Text
    keyText.Font = Enum.Font.Gotham
    keyText.TextSize = 14
    keyText.TextXAlignment = Enum.TextXAlignment.Left
    keyText.Parent = keyFrame
    
    local keyBtn = Instance.new("TextButton")
    keyBtn.Name = "KeyBtn"
    keyBtn.Size = UDim2.new(0, 40, 0, 20)
    keyBtn.Position = UDim2.new(0.9, -40, 0.5, -10)
    keyBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    keyBtn.BorderSizePixel = 0
    keyBtn.Text = "None"
    keyBtn.TextColor3 = self.themes[self.currentTheme].Text
    keyBtn.Font = Enum.Font.Gotham
    keyBtn.TextSize = 12
    keyBtn.Parent = keyFrame
    
    local listening = false
    local currentKey = "None"
    
    keyBtn.MouseButton1Click:Connect(function()
        listening = true
        keyBtn.Text = "..."
    end)
    
    UserInputService.InputBegan:Connect(function(input)
        if listening then
            local key = input.KeyCode.Name
            currentKey = key
            keyBtn.Text = key
            listening = false
        else
            if input.KeyCode.Name == currentKey and currentKey ~= "None" then
                callback()
            end
        end
    end)
    
    table.insert(page.elements, keyFrame)
    return keyFrame
end

function AxocaUi:AddSwitch(section, text, callback)
    return self:AddToggle(section, text, callback)
end

return AxocaUi
